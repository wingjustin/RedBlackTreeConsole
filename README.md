# RedBlackTreeConsole

<h3>Red-Black Tree</h3>

<p>
紅黑樹是每個節點都帶有顏色屬性的二叉搜尋樹，顏色為紅色或黑色。在二叉搜尋樹強制一般要求以外，對於任何有效的紅黑樹我們增加了如下的額外要求：
<br><br>
1. 節點是紅色或黑色。
<br><br>
2. 根是黑色。
<br><br>
3. 所有葉子都是黑色（葉子是NIL節點）。
<br><br>
4. 每個紅色節點必須有兩個黑色的子節點。（或者說從每個葉子到根的所有路徑上不能有兩個連續的紅色節點。）（或者說不存在兩個相鄰的紅色節點，相鄰指兩個節點是父子關係。）（或者說紅色節點的父節點和子節點均是黑色的。）
<br><br>
5. 從任一節點到其每個葉子的所有簡單路徑都包含相同數目的黑色節點。
<br><br>
來源: https://zh.wikipedia.org/zh-hk/%E7%BA%A2%E9%BB%91%E6%A0%91

</p>

<hr>

<div>關於插入操作和刪除操作, 先把紅黑樹理解成紅樹和黑樹, 紅樹子左右樹高度之差維持<=1, 黑樹子左右樹高度之差維持0 (要求5)</div>
<br><br>
<hr>

<div>插入操作, 重點考慮紅樹平衡, 留意父節點, 祖父 和 Uncle :</div>

<br>
<ul>

<li> 1. 新節點為紅節點, 如果父節點為黑色即完成操作。</li>
<br>
        <li>
<div> 2. 如果父節點為紅色, 紅節點與紅節點有兩個黑色的子節點 (要求4), 先看Uncle顏色, </div>
        <br>
        <ul>
		<li> 2.1 若果為紅色, 表示當前紅子樹的子左右樹高度之差<=1, 變色處理即可
		<br>, 祖父將變為紅色。若果祖父為根,變為黑色結束操作, 整體黑樹高度加1。若果祖父不為根,把當前點指向祖父進入下一次迭代。</li>
		<br>
		<li> 2.2 若果Uncle為黑色, 表示當前紅子樹的子左右樹高度之差>1, 需要進行旋轉操作與變色處理, 看情況分LL,RR,LR,RL,與AVL相似, 最後祖父將會變為黑色,結束操作。</li>
		<br>
	</ul>
</li>

</ul>

<hr>

<div>刪除操作, 重點考慮黑樹平衡, 留意父節點, 兄弟 和 Nephews。
<br>變色策略為新父節點為根則黑色,否則變回舊父節點顏色,再跟據(要求4)對其他節點變色 :</div>

<br>
<ul>

<li>1. 先刪除當前節點, 子節點為替換節點
	<br>, 當前替換節點的黑樹高度與當前節點的兄弟節點黑樹高度相差-1。 
	<br>若果替換節點為紅色, 變為黑色即可令當前高度加1, 與兄弟節點平衡結束操作。
	<br>若果替換節點為黑色, 則之後可能需要進行旋轉操作, 先把當前節點指向替換節點進入下一步。</li>
<br>
<li>2. 先考慮兄弟節點為紅色(第2簡單情況), 父節點與nephews必為黑色, 對父節點與兄弟節點進行一次左旋或右旋和變色
	<br>, 雖然現在當前節點黑樹高度相對新兄弟節點仍然相差-1,但新兄弟節點是舊nephew,必為黑色, 父節點沒變但顏色會變為紅色維持整體黑樹高度。
	<br>現在可以只考慮兄弟節點為黑色,當前節點沒變,迭代進入下一步。</li>
  <br> 
<li>
	<div>3. 先考慮其中一個或兩個nephew節點為紅色, </div>
	<br>
<ul>
<li>3.1. 若果當前節點為父節點的左子樹, 紅nephew為兄弟節點的右子樹, 則對父節點與兄弟節點進行一次左旋和變色。
	<br>, 最後無論新祖父節點變為什麼顏色, 黑樹已平衡, 整體黑樹高度也沒變, 結束操作。</li>
    <br>
<li>3.2. 若果當前節點為父節點的左子樹, 紅nephew為兄弟節點的左子樹, 則先對兄弟節點與紅nephew進行一次右旋, 之後對父節點與新兄弟節點進行一次左旋,再變色。
	<br>, 最後無論新祖父節點變為什麼顏色, 黑樹已平衡, 整體黑樹高度也沒變, 結束操作。</li>
    <br>
<li>3.3. 若果兩個nephews節點都是紅色, 把它當作3.1.1. 情況處理。 若果當前節點為父節點的右子樹, 用相仿的方法即可。</li>
	<br>
</ul>
<li>
	<div>4. 最後考慮情況為兩個nephews節點都是黑色, 先把兄弟節點變為紅色令其黑樹高度-1, 與當前節點黑樹高度平衡。
			<br>這時整體黑樹高度也會-1, 所以要再以父節點顏色分兩種情況</div>
	<br>
	<ul>
		<li>4.1 若果父節點為紅色, 把父節點變黑色令整體黑樹高度+1, 結束操作。</li>
		<br>
		<li>4.2 若果父節點為黑色, 父節點為根則結束操作,否則把當前節點指向父節點迭代進入下一步。</li>
		<br>
	</ul></li>

<li>5. 第2情況操作過後新兄弟節點必為黑色, 父節點必為紅色, 所以迭代進入下一步之後能夠在1到2次旋轉操作之後結束操作。<br>加上第2情況本身的1次旋轉, 整體刪除操作能夠在最多3次旋轉操作之後結束操作。</li>
	
</ul>
